import{j as e,b as y,d as g,S as v,s as d}from"./index-D_vtScmW.js";import{r}from"./react-vendor-Fq2Sw-nb.js";import{H as N}from"./admin-utils-lVyF4nhZ.js";import{u as A}from"./router-CFMIZ337.js";import{a as E,E as S}from"./eye-TWnNF4gi.js";import{A as P}from"./alert-triangle-B5gdcnoa.js";import"./auth-DoljvRgB.js";function H(){const o=A(),[l,p]=r.useState(""),[m,b]=r.useState(""),[u,j]=r.useState(!1),[x,s]=r.useState(""),[h,i]=r.useState(!1);r.useEffect(()=>{(async()=>{const{data:{session:t}}=await d.auth.getSession();t?.user?.email==="davisricart@gmail.com"&&o("/admin/dashboard")})()},[o]);const w=async a=>{a.preventDefault(),s(""),i(!0);try{if(l!=="davisricart@gmail.com"){s("Unauthorized access. This is a secure admin portal."),i(!1);return}const{data:t,error:n}=await d.auth.signInWithPassword({email:l,password:m});if(n){if(console.error("Supabase auth error:",n),n.message.includes("Invalid login credentials"))try{console.log("Admin account not found, attempting to create...");const{data:c,error:f}=await d.auth.signUp({email:l,password:m});if(f){s(`Failed to create admin account: ${f.message}`),i(!1);return}c.user&&(console.log("Admin account created successfully"),c.session?o("/admin/dashboard"):s("Admin account created. Please check your email to confirm your account, then try logging in again."))}catch(c){console.error("Error creating admin account:",c),s("Unable to create admin account. Please contact support.")}else n.message.includes("Email not confirmed")?s("Email not confirmed. Please check your email for confirmation link."):s(`Authentication failed: ${n.message}`);i(!1);return}t.user&&t.user.email==="davisricart@gmail.com"?(console.log("Admin authentication successful"),o("/admin/dashboard")):(s("Unauthorized access. Admin privileges required."),await d.auth.signOut())}catch(t){console.error("Admin login error:",t),s("Authentication system error. Please try again.")}finally{i(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-emerald-50 to-white",children:[e.jsxs(N,{children:[e.jsx("title",{children:"Admin Login | GR Balance"}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsx("nav",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("a",{href:"/",className:"flex items-center gap-2 text-emerald-600 hover:text-emerald-700 transition-colors duration-200",children:[e.jsx(y,{className:"h-5 w-5"}),"Back to Home"]})})})}),e.jsx("main",{className:"flex items-center justify-center px-4 py-12",children:e.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-xl shadow-lg w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-3 mb-6",children:[e.jsx("img",{src:g.logo,alt:`${g.title} Logo`,className:"h-28 sm:h-32 w-auto object-contain"}),e.jsx("h2",{className:"text-emerald-700 text-center text-base sm:text-lg font-medium",children:"Admin Login"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-emerald-600 mb-1.5",children:"Email"}),e.jsx("input",{type:"email",value:l,onChange:a=>p(a.target.value),className:"w-full px-3 py-2.5 rounded-lg border border-emerald-100 focus:ring-2 focus:ring-emerald-400/50 focus:border-transparent transition duration-200",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-emerald-600 mb-1.5",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:u?"text":"password",value:m,onChange:a=>b(a.target.value),className:"w-full px-3 py-2.5 rounded-lg border border-emerald-100 focus:ring-2 focus:ring-emerald-400/50 focus:border-transparent transition duration-200",required:!0}),e.jsx("button",{type:"button",onClick:()=>j(!u),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-emerald-600 transition-colors",children:u?e.jsx(E,{className:"h-4 w-4"}):e.jsx(S,{className:"h-4 w-4"})})]})]}),x&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"text-red-700 text-sm",children:x})]})}),e.jsx("button",{type:"submit",disabled:h,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-2.5 px-4 rounded-lg transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Signing in..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"h-4 w-4"}),"Access Admin Dashboard"]})})]})]})})]})}export{H as default};
